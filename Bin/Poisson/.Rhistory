trutta_subset <- trutta[, c("generation", "year",
"richesse_trutta", "fst_1_2_trutta", "fst_2_3_trutta")]
trutta_sans_A_subset <- trutta_sans_A_futur[, c("generation", "year",
"richesse_trutta_sans_A",
"fst_1_2_trutta_sans_A",
"fst_2_3_trutta_sans_A")]
trutta_sans_B_subset <- trutta_sans_B_futur[, c("generation", "year",
"richesse_trutta_sans_B",
"fst_1_2_trutta_sans_B",
"fst_2_3_trutta_sans_B")]
# Fusionner les tableaux
Trutta_predictions <- Reduce(function(x, y) merge(x, y, by = c("generation", "year"), all = FALSE),
list(trutta_subset, trutta_sans_A_subset, trutta_sans_B_subset))
#### Tableau GOBIO ####
colnames(gobio) <- c("generation", "alive.rpl", "richesse_gobio",
"fst_1_2_gobio", "fst_1_3_gobio", "fst_2_3_gobio", "year")
colnames(gobio_sans_A_futur) <- c("generation", "alive.rpl", "richesse_gobio_sans_A",
"fst_1_2_gobio_sans_A", "fst_1_3_gobio_sans_A",
"fst_2_3_gobio_sans_A", "year")
colnames(gobio_sans_B_futur) <- c("generation", "alive.rpl", "richesse_gobio_sans_B",
"fst_1_2_gobio_sans_B", "fst_1_3_gobio_sans_B",
"fst_2_3_gobio_sans_B", "year")
gobio_subset <- gobio[, c("generation", "year",
"richesse_gobio", "fst_1_2_gobio", "fst_2_3_gobio")]
gobio_sans_A_subset <- gobio_sans_A_futur[, c("generation", "year",
"richesse_gobio_sans_A",
"fst_1_2_gobio_sans_A",
"fst_2_3_gobio_sans_A")]
gobio_sans_B_subset <- gobio_sans_B_futur[, c("generation", "year",
"richesse_gobio_sans_B",
"fst_1_2_gobio_sans_B",
"fst_2_3_gobio_sans_B")]
Gobio_predictions <- Reduce(function(x, y) merge(x, y, by = c("generation", "year"), all = FALSE),
list(gobio_subset, gobio_sans_A_subset, gobio_sans_B_subset))
colnames(septimaniae) <- c("generation", "alive.rpl", "richesse_septimaniae",
"fst_1_2_septimaniae", "fst_1_3_septimaniae", "fst_2_3_septimaniae", "year")
colnames(septimaniae_sans_A_futur) <- c("generation", "alive.rpl", "richesse_septimaniae_sans_A",
"fst_1_2_septimaniae_sans_A", "fst_1_3_septimaniae_sans_A",
"fst_2_3_septimaniae_sans_A", "year")
colnames(septimaniae_sans_B_futur) <- c("generation", "alive.rpl", "richesse_septimaniae_sans_B",
"fst_1_2_septimaniae_sans_B", "fst_1_3_septimaniae_sans_B",
"fst_2_3_septimaniae_sans_B", "year")
septimaniae_subset <- septimaniae[, c("generation", "year",
"richesse_septimaniae", "fst_1_2_septimaniae", "fst_2_3_septimaniae")]
septimaniae_sans_A_subset <- septimaniae_sans_A_futur[, c("generation", "year",
"richesse_septimaniae_sans_A",
"fst_1_2_septimaniae_sans_A",
"fst_2_3_septimaniae_sans_A")]
septimaniae_sans_B_subset <- septimaniae_sans_B_futur[, c("generation", "year",
"richesse_septimaniae_sans_B",
"fst_1_2_septimaniae_sans_B",
"fst_2_3_septimaniae_sans_B")]
Septimaniae_predictions <- Reduce(function(x, y) merge(x, y, by = c("generation", "year"), all = FALSE),
list(septimaniae_subset, septimaniae_sans_A_subset, septimaniae_sans_B_subset))
######## Prediction Rich. All. /sp ########
#### S. Trutta ####
# Définir les limites de l'axe des Y
y_lim <- c(min(c(min(Trutta_predictions$richesse_trutta, na.rm = TRUE),
min(Trutta_predictions$richesse_trutta_sans_A, na.rm = TRUE),
min(Trutta_predictions$richesse_trutta_sans_B, na.rm = TRUE))),
max(c(max(Trutta_predictions$richesse_trutta, na.rm = TRUE),
max(Trutta_predictions$richesse_trutta_sans_A, na.rm = TRUE),
max(Trutta_predictions$richesse_trutta_sans_B, na.rm = TRUE))))
# Tracer un graphique vide
plot(Trutta_predictions$year, Trutta_predictions$richesse_trutta,
type = "n",  # Ne trace rien, juste le cadre
xlab = "Années",
ylab = "Nbr. All./Locus",
ylim = y_lim,
cex.lab = 1.3,
bty = "l")
# Ajouter une zone grisée avant 2025
rect(xleft = 0, xright = 2025,
ybottom = par("usr")[3], ytop = par("usr")[4],
col = rgb(0.3, 0.3, 0.3, 0.3), border = NA)
# Ajouter les points pour chaque colonne
points(Trutta_predictions$year, Trutta_predictions$richesse_trutta,
col = "grey50", pch = 18, type = "b", lwd = 1.5)  # Richesse trutta (colonne 3)
points(Trutta_predictions$year, Trutta_predictions$richesse_trutta_sans_A,
col = "dodgerblue", pch = 17, type = "b", lwd = 1.5)  # Richesse trutta sans A (colonne 6)
points(Trutta_predictions$year, Trutta_predictions$richesse_trutta_sans_B,
col = "chocolate1", pch = 16, type = "b", lwd = 1.5)  # Richesse trutta sans B (colonne 9)
# Ajouter une légende
legend("topright",
legend = c("Aucun", "Barrage A", "Barrage B"),
col = c("grey50", "dodgerblue", "chocolate1"),
pch = c(18, 17, 16),
lty = 1,
bty = "n",
cex=1.3)
mtext("a)", side = 3, line = 1, adj = 0, font = 2,cex=2)
#### C. Gobio ####
# Définir les limites de l'axe des Y pour Gobio
y_lim_gobio <- c(
min(c(min(Gobio_predictions$richesse_gobio, na.rm = TRUE),
min(Gobio_predictions$richesse_gobio_sans_A, na.rm = TRUE),
min(Gobio_predictions$richesse_gobio_sans_B, na.rm = TRUE))),
max(c(max(Gobio_predictions$richesse_gobio, na.rm = TRUE),
max(Gobio_predictions$richesse_gobio_sans_A, na.rm = TRUE),
max(Gobio_predictions$richesse_gobio_sans_B, na.rm = TRUE)))
)
# Tracer un graphique vide pour Gobio
plot(Gobio_predictions$year, Gobio_predictions$richesse_gobio,
type = "n",  # Ne trace rien, juste le cadre
xlab = "Années",
ylab = "Nbr. All./Locus",
ylim = y_lim_gobio,
cex.lab = 1.3,
bty = "l")
rect(xleft = 0, xright = 2025,
ybottom = par("usr")[3], ytop = par("usr")[4],
col = rgb(0.3, 0.3, 0.3, 0.3), border = NA)
# Ajouter les points pour chaque colonne
points(Gobio_predictions$year, Gobio_predictions$richesse_gobio,
col = "grey50", pch = 18, type = "b", lwd = 1.5)  # Richesse gobio
points(Gobio_predictions$year, Gobio_predictions$richesse_gobio_sans_A,
col = "dodgerblue", pch = 17, type = "b", lwd = 1.5)  # Richesse gobio sans A
points(Gobio_predictions$year, Gobio_predictions$richesse_gobio_sans_B,
col = "chocolate1", pch = 16, type = "b", lwd = 1.5)  # Richesse gobio sans B
mtext("c)", side = 3, line = 1, adj = 0, font = 2,cex=2)
#### Septimaniae ####
# Définir les limites de l'axe des Y pour Septimaniae
y_lim_septimaniae <- c(
min(c(min(Septimaniae_predictions$richesse_septimaniae, na.rm = TRUE),
min(Septimaniae_predictions$richesse_septimaniae_sans_A, na.rm = TRUE),
min(Septimaniae_predictions$richesse_septimaniae_sans_B, na.rm = TRUE))),
max(c(max(Septimaniae_predictions$richesse_septimaniae, na.rm = TRUE),
max(Septimaniae_predictions$richesse_septimaniae_sans_A, na.rm = TRUE),
max(Septimaniae_predictions$richesse_septimaniae_sans_B, na.rm = TRUE)))
)
# Tracer un graphique vide pour Septimaniae
plot(Septimaniae_predictions$year, Septimaniae_predictions$richesse_septimaniae,
type = "n",  # Ne trace rien, juste le cadre
xlab = "Années",
ylab = "Nbr. All./Locus",
ylim = y_lim_septimaniae,
cex.lab = 1.3,
bty = "l")
rect(xleft = 0, xright = 2025,
ybottom = par("usr")[3], ytop = par("usr")[4],
col = rgb(0.3, 0.3, 0.3, 0.3), border = NA)
# Ajouter les points pour chaque colonne
points(Septimaniae_predictions$year, Septimaniae_predictions$richesse_septimaniae,
col = "grey50", pch = 18, type = "b", lwd = 1.5)  # Richesse septimaniae
points(Septimaniae_predictions$year, Septimaniae_predictions$richesse_septimaniae_sans_A,
col = "dodgerblue", pch = 17, type = "b", lwd = 1.5)  # Richesse septimaniae sans A
points(Septimaniae_predictions$year, Septimaniae_predictions$richesse_septimaniae_sans_B,
col = "chocolate1", pch = 16, type = "b", lwd = 1.5)  # Richesse septimaniae sans B
mtext("b)", side = 3, line = 1, adj = 0, font = 2,cex=2)
######## Prédictions Fst selon sp et traitements ########
#### Préparation data Fst barrage A ####
# Calculer Fst/(1-Fst) pour Trutta
Trutta_predictions$fst_ratio_trutta <- Trutta_predictions$fst_1_2_trutta / (1 - Trutta_predictions$fst_1_2_trutta)
Trutta_predictions$fst_ratio_trutta_sans_A <- Trutta_predictions$fst_1_2_trutta_sans_A / (1 - Trutta_predictions$fst_1_2_trutta_sans_A)
# Calculer Fst/(1-Fst) pour Gobio
Gobio_predictions$fst_ratio_gobio <- Gobio_predictions$fst_1_2_gobio / (1 - Gobio_predictions$fst_1_2_gobio)
Gobio_predictions$fst_ratio_gobio_sans_A <- Gobio_predictions$fst_1_2_gobio_sans_A / (1 - Gobio_predictions$fst_1_2_gobio_sans_A)
# Calculer Fst/(1-Fst) pour Septimaniae
Septimaniae_predictions$fst_ratio_septimaniae <- Septimaniae_predictions$fst_1_2_septimaniae / (1 - Septimaniae_predictions$fst_1_2_septimaniae)
Septimaniae_predictions$fst_ratio_septimaniae_sans_A <- Septimaniae_predictions$fst_1_2_septimaniae_sans_A / (1 - Septimaniae_predictions$fst_1_2_septimaniae_sans_A)
# Définir les limites des axes
y_lim_fst_ratio <- c(
min(c(min(Trutta_predictions$fst_ratio_trutta, na.rm = TRUE),
min(Trutta_predictions$fst_ratio_trutta_sans_A, na.rm = TRUE),
min(Gobio_predictions$fst_ratio_gobio, na.rm = TRUE),
min(Gobio_predictions$fst_ratio_gobio_sans_A, na.rm = TRUE),
min(Septimaniae_predictions$fst_ratio_septimaniae, na.rm = TRUE),
min(Septimaniae_predictions$fst_ratio_septimaniae_sans_A, na.rm = TRUE))),
max(c(max(Trutta_predictions$fst_ratio_trutta, na.rm = TRUE),
max(Trutta_predictions$fst_ratio_trutta_sans_A, na.rm = TRUE),
max(Gobio_predictions$fst_ratio_gobio, na.rm = TRUE),
max(Gobio_predictions$fst_ratio_gobio_sans_A, na.rm = TRUE),
max(Septimaniae_predictions$fst_ratio_septimaniae, na.rm = TRUE),
max(Septimaniae_predictions$fst_ratio_septimaniae_sans_A, na.rm = TRUE)))
)
#### Graphique Fst barrage A ####
par(mgp = c(2.5, 1, 0))
plot(1, type = "n",
xlab = "Années",
ylab = expression(italic(F[ST]/(1 - F[ST]))),
xlim = c(min(Trutta_predictions$year), max(Trutta_predictions$year)),
ylim = y_lim_fst_ratio,
cex.lab = 1.3,
bty = "l")
# Définir les couleurs avec transparence pour les tirets
transparent_darkgreen <- adjustcolor("darkgreen", alpha.f = 0.7)       # Trutta
transparent_darkgoldenrod <- adjustcolor("darkgoldenrod1", alpha.f = 0.7) # Gobio
transparent_blue <- adjustcolor("blue", alpha.f = 0.7)                 # Septimaniae
# Ajouter les courbes pour Trutta
lines(Trutta_predictions$year, Trutta_predictions$fst_ratio_trutta,
col = transparent_darkgreen, lty = 2, lwd = 1.75)  # Barrage intact (tirets, transparent)
lines(Trutta_predictions$year, Trutta_predictions$fst_ratio_trutta_sans_A,
col = "darkgreen", lty = 1, lwd = 1.75)  # Sans barrage A (ligne continue)
# Ajouter les courbes pour Gobio
lines(Gobio_predictions$year, Gobio_predictions$fst_ratio_gobio,
col = transparent_darkgoldenrod, lty = 2, lwd = 1.75)  # Barrage intact (tirets, transparent)
lines(Gobio_predictions$year, Gobio_predictions$fst_ratio_gobio_sans_A,
col = "darkgoldenrod1", lty = 1, lwd = 1.75)  # Sans barrage A (ligne continue)
# Ajouter les courbes pour Septimaniae
lines(Septimaniae_predictions$year, Septimaniae_predictions$fst_ratio_septimaniae,
col = transparent_blue, lty = 2, lwd = 1.75)  # Barrage intact (tirets, transparent)
lines(Septimaniae_predictions$year, Septimaniae_predictions$fst_ratio_septimaniae_sans_A,
col = "blue", lty = 1, lwd = 1.75)  # Sans barrage A (ligne continue)
# Ajouter la zone grisée avant 2025
rect(xleft = 0, xright = 2025,
ybottom = par("usr")[3], ytop = par("usr")[4],
col = rgb(0.3, 0.3, 0.3, 0.3), border = NA)
# Ajouter une légende
legend("topleft",
legend = c(expression(italic("C. gobio")),
expression(italic("P. septimaniae")),
expression(italic("S. trutta"))),
col = c("darkgoldenrod1", "blue", "darkgreen"),  # Couleurs des espèces
pch = 15,  # Rectangle coloré pour chaque espèce
bty = "n",  # Pas de bordure autour de la légende
pt.cex = 1.5,  # Taille des rectangles de couleur
cex = 1.3)  # Taille du texte
mtext("a)", side = 3, line = 1, adj = 0, font = 2,cex=2)
Trutta_predictions$fst_ratio_trutta <- Trutta_predictions$fst_2_3_trutta / (1 - Trutta_predictions$fst_2_3_trutta)
Trutta_predictions$fst_ratio_trutta_sans_B <- Trutta_predictions$fst_2_3_trutta_sans_B / (1 - Trutta_predictions$fst_2_3_trutta_sans_B)
Gobio_predictions$fst_ratio_gobio <- Gobio_predictions$fst_2_3_gobio / (1 - Gobio_predictions$fst_2_3_gobio)
Gobio_predictions$fst_ratio_gobio_sans_B <- Gobio_predictions$fst_2_3_gobio_sans_B / (1 - Gobio_predictions$fst_2_3_gobio_sans_B)
Septimaniae_predictions$fst_ratio_septimaniae <- Septimaniae_predictions$fst_2_3_septimaniae / (1 - Septimaniae_predictions$fst_2_3_septimaniae)
Septimaniae_predictions$fst_ratio_septimaniae_sans_B <- Septimaniae_predictions$fst_2_3_septimaniae_sans_B / (1 - Septimaniae_predictions$fst_2_3_septimaniae_sans_B)
y_lim_fst_ratio <- c(
min(c(min(Trutta_predictions$fst_ratio_trutta, na.rm = TRUE),
min(Trutta_predictions$fst_ratio_trutta_sans_B, na.rm = TRUE),
min(Gobio_predictions$fst_ratio_gobio, na.rm = TRUE),
min(Gobio_predictions$fst_ratio_gobio_sans_B, na.rm = TRUE),
min(Septimaniae_predictions$fst_ratio_septimaniae, na.rm = TRUE),
min(Septimaniae_predictions$fst_ratio_septimaniae_sans_B, na.rm = TRUE))),
max(c(max(Trutta_predictions$fst_ratio_trutta, na.rm = TRUE),
max(Trutta_predictions$fst_ratio_trutta_sans_B, na.rm = TRUE),
max(Gobio_predictions$fst_ratio_gobio, na.rm = TRUE),
max(Gobio_predictions$fst_ratio_gobio_sans_B, na.rm = TRUE),
max(Septimaniae_predictions$fst_ratio_septimaniae, na.rm = TRUE),
max(Septimaniae_predictions$fst_ratio_septimaniae_sans_B, na.rm = TRUE)))
)
#### Graphique Fst barrage B ####
par(mgp = c(2.5, 1, 0))
plot(1, type = "n",
xlab = "Années",
ylab= "  ",
xlim = c(min(Trutta_predictions$year), max(Trutta_predictions$year)),
ylim = y_lim_fst_ratio,
cex.lab = 1.3,
bty = "l")
transparent_darkgreen <- adjustcolor("darkgreen", alpha.f = 0.7)       # Trutta
transparent_darkgoldenrod <- adjustcolor("darkgoldenrod1", alpha.f = 0.7) # Gobio
transparent_blue <- adjustcolor("blue", alpha.f = 0.7)                 # Septimaniae
lines(Trutta_predictions$year, Trutta_predictions$fst_ratio_trutta,
col = transparent_darkgreen, lty = 2, lwd = 1.75)
lines(Trutta_predictions$year, Trutta_predictions$fst_ratio_trutta_sans_B,
col = "darkgreen", lty = 1, lwd = 1.75)
lines(Gobio_predictions$year, Gobio_predictions$fst_ratio_gobio,
col = transparent_darkgoldenrod, lty = 2, lwd = 1.75)
lines(Gobio_predictions$year, Gobio_predictions$fst_ratio_gobio_sans_B,
col = "darkgoldenrod1", lty = 1, lwd = 1.75)
lines(Septimaniae_predictions$year, Septimaniae_predictions$fst_ratio_septimaniae,
col = transparent_blue, lty = 2, lwd = 1.75)
lines(Septimaniae_predictions$year, Septimaniae_predictions$fst_ratio_septimaniae_sans_B,
col = "blue", lty = 1, lwd = 1.75)
rect(xleft = 0, xright = 2025,
ybottom = par("usr")[3], ytop = par("usr")[4],
col = rgb(0.3, 0.3, 0.3, 0.3), border = NA)
mtext("b)", side = 3, line = 1, adj = 0, font = 2, cex = 2)
trutta_sans <- read.table("../../F_index/Sans_barrage/Trutta_sans/trutta_sans_mean.txt", header = TRUE)
gobio_sans <- read.table("../../F_index/Sans_barrage/Gobio_sans/gobio_sans_mean.txt", header = TRUE)
septimaniae_sans <- read.table("../../F_index/Sans_barrage/Septimaniae_sans/septimaniae_sans_mean.txt", header = TRUE)
trutta_just_A <- read.table("../../F_index/Just_A/Trutta_just_A/trutta_just_A_mean.txt", header = TRUE)
gobio_just_A <- read.table("../../F_index/Just_A/Gobio_just_A/gobio_just_A_mean.txt", header = TRUE)
septimaniae_just_A <- read.table("../../F_index/Just_A/Septimaniae_just_A/septimaniae_just_A_mean.txt", header = TRUE)
trutta_just_B <- read.table("../../F_index/Just_B/Trutta_just_B/trutta_just_B_mean.txt", header = TRUE)
gobio_just_B <- read.table("../../F_index/Just_B/Gobio_just_B/gobio_just_B_mean.txt", header = TRUE)
septimaniae_just_B <- read.table("../../F_index/Just_B/Septimaniae_just_B/septimaniae_just_B_mean.txt", header = TRUE)
#Stats####
gobio_recent$esp<-"gobio"
septimaniae_recent$esp<-"septimaniae"
trutta_recent$esp<-"trutta"
names(gobio_recent)<-c("generation", "alive","Na","Fst_12","Fst_13","Fst_23","year","Fst_ratio","esp")
names(septimaniae_recent)<-names(gobio_recent)
names(trutta_recent)<-names(gobio_recent)
recent<-rbind(gobio_recent, septimaniae_recent)
recent<-rbind(recent, trutta_recent)
##tout les trucs en hastags c'est pour les conditions d'applications mais frère la je m'en blc un peu
#hist(recent$Na)
mod1=lm(Na~year*esp,data=recent)
anova(mod1)
#hist(residuals(mod1))
summary(mod1)
###script sliding windows contruit sur la base du script ACP 49 reines et le script libreria_filtri_VCF_e_SFS_unfolded(2)####
setwd("C:/Users/hugod/OneDrive/Stage MNHN/Rstudio/sliding-windows")
library(vcfR)
library(adegenet)
library(hierfstat)
library(ggplot2)
###script sliding windows contruit sur la base du script ACP 49 reines et le script libreria_filtri_VCF_e_SFS_unfolded(2)####
setwd("C:/Users/hugod/Documents/Stage_MNHN/Rstudio/sliding-windows")
library(vcfR)
library(adegenet)
library(hierfstat)
library(ggplot2)
library(dplyr)
dati<-read.vcfR("C:/Users/hugod/Documents/Stage_MNHN/Rstudio/sliding-windows/WGS_N49_4CHR_HET80_DP10_50_NA20_MAF0.05.vcf", verbose = TRUE)
View(gobio)
t.test(recent$Fst_12,recent$Fst_23)
#Stats####
gobio_recent$esp<-"gobio"
septimaniae_recent$esp<-"septimaniae"
trutta_recent$esp<-"trutta"
names(gobio_recent)<-c("generation", "alive","Na","Fst_12","Fst_13","Fst_23","year","Fst_ratio","esp")
names(septimaniae_recent)<-names(gobio_recent)
names(trutta_recent)<-names(gobio_recent)
recent<-rbind(gobio_recent, septimaniae_recent)
recent<-rbind(recent, trutta_recent)
##tout les trucs en hastags c'est pour les conditions d'applications mais frère la je m'en blc un peu
#hist(recent$Na)
mod1=lm(Na~year*esp,data=recent)
anova(mod1)
#hist(residuals(mod1))
summary(mod1)
mod2=lm(Fst_12~year*esp,data=recent)
anova(mod2)
summary(mod2)
mod3=lm(Fst_23~year*esp,data=recent)
anova(mod3)
summary(mod3)
t.test(recent$Fst_12,recent$Fst_23)
View(recent)
i=t.test(recent$Fst_12,recent$Fst_23)
i
summary(i)
library(dplyr)
library(tidyr)
recent2 <- recent %>%
pivot_longer(cols = c(Fst_12, Fst_23),    # Colonnes à fondre
names_to = "fst_type",       # Nouvelle colonne qui contient 'Fst_12' ou 'Fst_23'
values_to = "Fst_value")
View(recent2)
mod2=lm(Fst_value~fst_type*year*esp,data=recent)
summary(mod2)
value~fst_type*year*esp,data=recent2)
mod3=lm(Fst_value~fst_type*year*esp,data=recent2)
anova(mod3)
summary(mod3)
View(Gobio_predictions)
View(gobio_just_A)
View(gobio_just_B)
View(gobio_sans)
#F-index####
#Barrage A gobio
gobio_ <- gobio_just_B[1000, "n.adlt.fst.wc_p2.3"]
#F-index####
#Barrage A gobio
gobio_min <- gobio_just_B[1000, "n.adlt.fst.wc_p2.3"]
#F-index####
#Barrage A gobio
gobio_min_A <- gobio_just_B[1000, "n.adlt.fst.wc_p2.3"]
gobio_max_A <- gobio_just_B[1000, "n.adlt.fst.wc_p2.3"]
gobio_obs_A <- gobio_just_B[1000, "n.adlt.fst.wc_p2.3"]
#F-index####
#Barrage A gobio
gobio_min_A <- gobio_just_B[1000, "n.adlt.fst.wc_p2.3"]
View(gobio)
gobio_obs_A <- gobio[1000, "n.adlt.fst.wc_p2.3"]
Findex_gobio_A = ((log(gobio_min_A)-log(gobio_obs_A))/(log(gobio_min_A)-log(gobio_obs_A)))
#F-index####
#Barrage A gobio
gobio_min_A <- gobio_just_B[1000, "n.adlt.fst.wc_p2.3"]
gobio_obs_A <- gobio[1000, "n.adlt.fst.wc_p2.3"]
Findex_gobio_A = ((log(gobio_min_A)-log(gobio_obs_A))/(log(gobio_min_A)-log(gobio_obs_A)))
summarry(gobio_min_A)
summary(gobio_min_A)
str(gobio_min)
str(gobio_min_A)
str(gobio_obs_A)
gobio_obs_A <- gobio[1000, "fst_2_3_gobio"]
Findex_gobio_A = ((log(gobio_min_A)-log(gobio_obs_A))/(log(gobio_min_A)-log(gobio_obs_A)))
Findex_gobio_A
gobio_min_A-gobio_obs_A
gobio_min_B <- gobio_just_A[1000, "n.adlt.fst.wc_p1.2"]
gobio_obs_B <- gobio[1000, "fst_1_2_gobio"]
gobio_obs_B-gobio_min_B
gobio_obs_A-gobio_min_A
gobio_obs_B-gobio_min_B
View(septimaniae_sans_A_subset)
#Barrage septimaniae
septimaniae_min_A <- septimaniae_just_B[1000, "n.adlt.fst.wc_p2.3"]
septimaniae_obs_A <- septimaniae[1000, "fst_2_3_septimaniae"]
septimaniae_obs_A-septimaniae_min_A
septimaniae_min_B <- septimaniae_just_A[1000, "n.adlt.fst.wc_p1.2"]
septimaniae_obs_B <- septimaniae[1000, "fst_1_2_septimaniae"]
septimaniae_obs_B-septimaniae_min_B
#Barrage trutta
trutta_min_A <- trutta_just_B[1000, "n.adlt.fst.wc_p2.3"]
trutta_obs_A <- trutta[1000, "fst_2_3_trutta"]
trutta_obs_A-trutta_min_A
trutta_min_B <- trutta_just_A[1000, "n.adlt.fst.wc_p1.2"]
trutta_obs_B <- trutta[1000, "fst_1_2_trutta"]
trutta_obs_B-trutta_min_B
F-index####
gobio_min_A <- gobio_just_B[1000, "n.adlt.fst.wc_p2.3"]
gobio_obs_A <- gobio[1000, "fst_2_3_gobio"]
gobio_obs_A-gobio_min_A
gobio_min_B <- gobio_just_A[1000, "n.adlt.fst.wc_p1.2"]
gobio_obs_B <- gobio[1000, "fst_1_2_gobio"]
gobio_obs_B-gobio_min_B
#Barrage septimaniae
septimaniae_min_A <- septimaniae_just_B[1000, "n.adlt.fst.wc_p2.3"]
septimaniae_obs_A <- septimaniae[1000, "fst_2_3_septimaniae"]
septimaniae_obs_A-septimaniae_min_A
septimaniae_min_B <- septimaniae_just_A[1000, "n.adlt.fst.wc_p1.2"]
septimaniae_obs_B <- septimaniae[1000, "fst_1_2_septimaniae"]
septimaniae_obs_B-septimaniae_min_B
#Barrage trutta
trutta_min_A <- trutta_just_B[1000, "n.adlt.fst.wc_p2.3"]
trutta_obs_A <- trutta[1000, "fst_2_3_trutta"]
trutta_obs_A-trutta_min_A
trutta_min_B <- trutta_just_A[1000, "n.adlt.fst.wc_p1.2"]
trutta_obs_B <- trutta[1000, "fst_1_2_trutta"]
trutta_obs_B-trutta_min_B
View(gobio_sans_A_futur)
View(gobio_sans_A)
View(gobio_sans_A_futur)
View(gobio)
View(Gobio_predictions)
View(Septimaniae_predictions)
View(Trutta_predictions)
View(gobio)
View(gobio_just_A)
View(gobio_sans_A_futur)
View(gobio_sans_A_subset)
View(gobio_sans_B_futur)
View(gobio_sans_B)
View(gobio)
###le futur ####
gobio_futur=gobio[800:868,]
gobio_futur$bar="all"
View(gobio_futur)
gobio_sans_A_futur$bar="noA"
gobio_sans_B_futur$bar="noB"
gobio_pred<-rbind(gobio_futur, gobio_sans_A_futur)
gobio_pred<-rbind(gobio_pred, gobio_sans_B_futur)
gobio_sans_A_futur$bar="noA"
View(gobio_sans_A_futur)
View(gobio_sans_B_futur)
names(gobio_futur)<-c("generation", "alive","Na","Fst_12","Fst_13","Fst_23","year","Fst_ratio","bar")
names(gobio_futur)<-c("generation", "alive","Na","Fst_12","Fst_13","Fst_23","Fst_ratio","bar")
View(gobio_futur)
names(gobio_futur)<-c("generation", "alive","Na","Fst_12","Fst_13","Fst_23","Fst_ratio","bar")
names(gobio_sans_A_futur)<-names(gobio_futur)
names(gobio_sans_B_futur)<-names(gobio_futur)
gobio_pred<-rbind(gobio_futur, gobio_sans_A_futur)
gobio_pred<-rbind(gobio_pred, gobio_sans_B_futur)
View(gobio_pred)
mod3=lm(Na~year*bar,data=gobio_pred)
anova(mod3)
summary(mod3)
mod3=lm(Na~year*bar,data=gobio_pred)
names(gobio_futur)<-c("generation", "alive","Na","Fst_12","Fst_13","Fst_23","year","bar")
names(gobio_sans_A_futur)<-names(gobio_futur)
names(gobio_sans_B_futur)<-names(gobio_futur)
gobio_pred<-rbind(gobio_futur, gobio_sans_A_futur)
gobio_pred<-rbind(gobio_pred, gobio_sans_B_futur)
mod3=lm(Na~year*bar,data=gobio_pred)
anova(mod3)
summary(mod3)
septimaniae_futur=septimaniae[800:868,]
septimaniae_futur$bar="all"
septimaniae_sans_A_futur$bar="noA"
septimaniae_sans_B_futur$bar="noB"
names(septimaniae_futur)<-c("generation", "alive","Na","Fst_12","Fst_13","Fst_23","year","bar")
names(septimaniae_sans_A_futur)<-names(septimaniae_futur)
names(septimaniae_sans_B_futur)<-names(septimaniae_futur)
septimaniae_pred<-rbind(septimaniae_futur, septimaniae_sans_A_futur)
septimaniae_pred<-rbind(septimaniae_pred, septimaniae_sans_B_futur)
modseptimaniae=lm(Na~year*bar,data=septimaniae_pred)
anova(modseptimaniae)
summary(modseptimaniae)
trutta_futur=trutta[800:868,]
trutta_futur$bar="all"
trutta_sans_A_futur$bar="noA"
trutta_sans_B_futur$bar="noB"
names(trutta_futur)<-c("generation", "alive","Na","Fst_12","Fst_13","Fst_23","year","bar")
names(trutta_sans_A_futur)<-names(trutta_futur)
names(trutta_sans_B_futur)<-names(trutta_futur)
trutta_pred<-rbind(trutta_futur, trutta_sans_A_futur)
trutta_pred<-rbind(trutta_pred, trutta_sans_B_futur)
modtrutta=lm(Na~year*bar,data=trutta_pred)
anova(modtrutta)
summary(modtrutta)
View(gobio_pred)
#pour les Fst
tout_pred<-rbind(gobio_pred, trutta_pred)
tout_pred<-rbind(tout_pred, septimaniae_pred)
#pour les Fst
gobio_pred$esp="gobio"
trutta_pred$esp="trutta"
septimaniae_pred$esp="septimaniae"
tout_pred<-rbind(gobio_pred, trutta_pred)
tout_pred<-rbind(tout_pred, septimaniae_pred)
View(tout_pred)
tout_pred_A <- subset(tout_pred, bar %in% c("all", "noA"))
View(tout_pred_A)
tout_pred_B <- subset(tout_pred, bar %in% c("all", "noB"))
View(tout_pred_A)
modA=lm(Fst_12~year*bar*esp,data=tout_pred_A)
anova(modA)
summary(modA)
modB=lm(Fst_23~year*bar*esp,data=tout_pred_B)
anova(modB)
summary(modB)
